---
title: "排序之插入排序法 ( Insertion Sort )"
date: 2017-04-22T19:51:35+08:00
draft: false
tags: 
- algorithm 
keywords:
- algorithm 
- insertion sort
---

插入排序法是我們第一個學習到的排序方法，我們本篇會針對它來詳細的介紹一下。

* 插入排序法的原理
* 插入排序法的執行效能
* `javascript`演算法實作


## 插入排序法的原理

我們先來看看下圖，來理論一下它是著麼進行排序，該圖來源為此[interactivepython](https://www.google.com.tw/search?q=insertion+sort&source=lnms&tbm=isch&sa=X&ved=0ahUKEwiYobap6dfRAhUGjZQKHXgLBJ8Q_AUICSgC&biw=1280&bih=703#imgrc=PJ68QwsZAj6I-M%3A)。

首先，我們會將資料分成兩部份，已排序與未排序，然後我們會進行以下作業

> 將已排序資料與後一個資料進行比較，如果已排序資料大於它，則進行位移

我們下面將以前四行來進行說明。注意，下列的 A[0] 代表陣列的第一個位置。

* 第一行 : 已排序資料為`54`，然後我們與後一個`26`進行比較，`54大於26`因此我們會將`26`的位置替換成`54`，並將`26`插入至`54的原位`，結果為第二行。
* 第二行 : 已排序資料為`26、54`，然後我們與後一個`93`進行比較，`54小於93`因此不用進行位移，因為`26、54`為已排序資料，因此只需要比較`54`就好，結果為第三行。
* 第三行 : 已排序資料為`26、54、93`，然後與`17`進行比較，首先`93大於17`因此將`93`位移置`A[3]`，則時還沒插入喔，還要繼續比較，接下來`54大於17`因此將`54`位移至`A[2]`，然後`26大於17`，因此將`26`位移至`A[1]`，最後在將`17`插入剩餘的空間`A[0]`，結果為第四行。
* 第四行 : 已排序資料為`17、26、54、93`，開始與`77`進行比較，`93大於77`因此將`93`位移至`A[4]`的位置，然後`54小於77`，因此`54`不需要位移，最後將`77`插入至空缺的位置`A[3]`，當果為第五行。

![](http://yixiang8780.com/outImg/20170123-1.png)

## 插入排序法的執行效能

那這個排序演算法效能如何 ? 我們會分成最好與最壞與平均來看。

### 最好狀況

`O(n)` 

該演算法最好的情況是時間複雜度為`O(n)`，假設我們有下列陣列要排序。

```
[ 1 , 2 , 3 , 4 ] 
```

我們一看就知道，他不用進行排序，但演算法還不知道，所以它至少還是要跑個`for迴圈`，跑個`4`次，才知道它不用排序，因為我們這時最好的狀況就是只要跑`4`次，也就是陣列的大小。

### 最壞狀況

`O(n^2)`

假設我們要下列陣列要排序。

```
[ 4 , 3 , 2 , 1 ] 
```

對就是完全相反的，我們首先要跑`for迴圈`，然後裡面還要一個`while比較`，而且因為我們的陣列是完全相反的。

### 平均狀況

`O(n^2)`

我也不知道為啥平均是`O(n^2)`，真的。

### 建議使用情況

* 要排序的資料數量不大 : 平均是時間複雜度是`O(n^2)`，如果來個1百萬個 n，你看看會如何。
* 大部份的資料已排序 : 上面有說過，該演算法會將資料分成已排序與未排序的來進行比較，也就是說如果已排序的資料越多，你就可以少做越少的比較。


## javascript演算法實作

我們來看看它的演算法，我們採用`javascript`來進行撰寫。

```js
function insertionSort(arr) {
  if (!Array.isArray(arr))
    throw 'elements is not array';

  var len = arr.length;
  var i = 0,
    value = 0;
    
  for (var pos = 1; pos < len; pos++) {
    i = pos - 1;
		value = arr[pos];  //正在處理的值
		
	//判斷是否移位
    while (i >= 0 && arr[i] > value) { 
      arr[i + 1] = arr[i];
      i--;
    }
    
    // 插入新值
    arr[i + 1] = value;
    
      console.log(arr);
  }
}
```

簡單的測試一下。

```js
insertionSort([3,54,24,33,22,58,95,1,2,31])
```

![](http://yixiang8780.com/outImg/20170123-2.png)

## 參考資料
* [https://zh.wikipedia.org/wiki/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F](https://zh.wikipedia.org/wiki/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F)
* [http://www.books.com.tw/products/0010741391](http://www.books.com.tw/products/0010741391)
